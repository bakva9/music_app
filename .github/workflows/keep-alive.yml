name: Keep Alive

on:
  schedule:
    - cron: '*/5 * * * *'  # 5分ごとに実行（GitHub Actionsの遅延を考慮）

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Render
        run: |
          for i in 1 2 3; do
            status=$(curl -s -o /dev/null -w "%{http_code}" --max-time 30 https://music-app-6a76.onrender.com)
            echo "Attempt $i: HTTP $status"
            if [ "$status" -ge 200 ] && [ "$status" -lt 400 ]; then
              echo "Success"
              exit 0
            fi
            sleep 10
          done
          echo "All attempts failed"
          exit 1
