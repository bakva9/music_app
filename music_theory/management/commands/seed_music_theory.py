from django.core.management.base import BaseCommand
from music_theory.models import Topic


SEED_DATA = [
    # ===== 音階 (scale) =====
    {
        'title': 'メジャースケール',
        'slug': 'major-scale',
        'category': 'scale',
        'difficulty': 1,
        'tags': '長音階,イオニアン,全全半全全全半,ドレミファソラシド,major scale',
        'summary': 'メジャースケール（長音階）は、最も基本的な音階で「ドレミファソラシド」として知られる。全音-全音-半音-全音-全音-全音-半音の間隔で構成され、明るく安定した響きを持つ。あらゆる音楽理論の土台となるスケール。',
        'body': '''## 定義
メジャースケール（長音階）は、7つの音からなる音階で、全音(W)-全音(W)-半音(H)-全音(W)-全音(W)-全音(W)-半音(H) の間隔パターンで構成される。モードの観点からはイオニアンモードとも呼ばれる。西洋音楽のほぼすべての理論体系の基盤。

## 構成音
Cメジャースケールの場合:
C - D - E - F - G - A - B - C
（全 - 全 - 半 - 全 - 全 - 全 - 半）

各音の度数:
1(ルート) - 2(長2度) - 3(長3度) - 4(完全4度) - 5(完全5度) - 6(長6度) - 7(長7度)

## 具体例
各キーのメジャースケール:
- C: C D E F G A B（♯♭なし）
- G: G A B C D E F#（♯1つ）
- D: D E F# G A B C#（♯2つ）
- A: A B C# D E F# G#（♯3つ）
- F: F G A Bb C D E（♭1つ）
- Bb: Bb C D Eb F G A（♭2つ）
- Eb: Eb F G Ab Bb C D（♭3つ）

## 実践のポイント
メジャースケールはダイアトニックコードの基盤であり、コード進行の理解に不可欠。まずCメジャースケールを完全に理解し、五度圏に沿って他のキーに展開していくと効率的。メロディ作りやコード進行分析のすべての出発点となる。''',
        'related_slugs': ['minor-scale', 'pentatonic-scale', 'church-modes', 'diatonic-chords', 'key-signature'],
    },
    {
        'title': 'マイナースケール',
        'slug': 'minor-scale',
        'category': 'scale',
        'difficulty': 2,
        'tags': '短音階,ナチュラルマイナー,ハーモニックマイナー,メロディックマイナー,エオリアン,minor scale',
        'summary': 'マイナースケール（短音階）は暗く哀愁のある響きを持つ音階。ナチュラル・ハーモニック・メロディックの3種類があり、それぞれ異なる場面で使い分けられる。J-POPでも多用される重要なスケール。',
        'body': '''## 定義
マイナースケール（短音階）は3種類ある。ナチュラルマイナーはメジャースケールの第6音から始めたもの（エオリアンモード）で、全-半-全-全-半-全-全の間隔パターン。ハーモニックマイナーは第7音を半音上げたもの、メロディックマイナーは上行時に第6・7音を半音上げたもの。

## 構成音
Aナチュラルマイナー: A B C D E F G
（全 - 半 - 全 - 全 - 半 - 全 - 全）

Aハーモニックマイナー: A B C D E F G#
（第7音G→G#に半音上げ。V7コードの構成音を得るため）

Aメロディックマイナー（上行）: A B C D E F# G#
（第6・7音を半音上げ。上行メロディを滑らかにするため）

## 具体例
各キーのナチュラルマイナースケールと平行調:
- Am: A B C D E F G（平行調: Cメジャー）
- Em: E F# G A B C D（平行調: Gメジャー）
- Dm: D E F G A Bb C（平行調: Fメジャー）
- Bm: B C# D E F# G A（平行調: Dメジャー）
- F#m: F# G# A B C# D E（平行調: Aメジャー）

## 実践のポイント
J-POPではナチュラルマイナーが最も多く使われる。ハーモニックマイナーはV7→Imの強い解決感が必要な場面で有効。メロディックマイナーは上行メロディで増2度の不自然さを避けるために使用される。平行調（同じ調号を持つメジャーキー）との関係を理解することが重要。''',
        'related_slugs': ['major-scale', 'pentatonic-scale', 'key-signature', 'diatonic-chords'],
    },
    {
        'title': 'ペンタトニックスケール',
        'slug': 'pentatonic-scale',
        'category': 'scale',
        'difficulty': 1,
        'tags': '五音音階,ペンタ,マイナーペンタトニック,メジャーペンタトニック,ブルーノート,pentatonic',
        'summary': 'ペンタトニックスケールは5つの音で構成される音階。メジャースケールから4度と7度を除いた形（メジャーペンタ）で、不協和音が少なく扱いやすい。日本の演歌・民謡の「ヨナ抜き音階」もペンタトニックの一種。',
        'body': '''## 定義
ペンタトニックスケールは5音で構成される音階。メジャーペンタトニック（1-2-3-5-6）とマイナーペンタトニック（1-b3-4-5-b7）の2種類が一般的。メジャースケールから半音を含む音程（4度と7度）を除くことで、どの音を組み合わせても不協和が生じにくい。

## 構成音
Cメジャーペンタトニック: C D E G A
（全音 - 全音 - 短3度 - 全音 - 短3度）

Aマイナーペンタトニック: A C D E G
（短3度 - 全音 - 全音 - 短3度 - 全音）

※CメジャーペンタとAマイナーペンタは同じ構成音（平行調の関係）

ブルーススケール = マイナーペンタ + ブルーノート(b5):
Aブルーススケール: A C D Eb E G

## 具体例
世界中の民族音楽に見られるペンタトニック:
- 日本の「ヨナ抜き音階」: メジャーペンタトニックと同一（4番目と7番目の音を抜く）
- 日本の「ニロ抜き音階」: マイナーペンタトニックと同一
- スコットランド民謡「蛍の光」: ペンタトニックで構成
- 中国・東南アジアの伝統音楽

## 実践のポイント
ペンタトニックはメロディ作りの出発点として優秀。5音しかないため、音を外しにくく即興にも適している。ブルーノート（b5）を加えるとブルース/ロック的な色彩が増す。J-POPのメロディもペンタトニックを骨格にしている曲が多い。''',
        'related_slugs': ['major-scale', 'minor-scale', 'blues-form'],
    },
    {
        'title': 'モード（チャーチモード）',
        'slug': 'church-modes',
        'category': 'scale',
        'difficulty': 4,
        'tags': 'モード,チャーチモード,教会旋法,イオニアン,ドリアン,フリジアン,リディアン,ミクソリディアン,エオリアン,ロクリアン',
        'summary': 'モード（教会旋法）はメジャースケールの各音を起点とする7つのスケール。ドリアン、ミクソリディアンなどそれぞれ固有の響きを持ち、ジャズやポップスのモーダルインターチェンジの基礎となる。',
        'body': '''## 定義
モード（教会旋法/チャーチモード）は、メジャースケールの各音度を起点として得られる7つのスケールの総称。各モードは固有の特性音（キャラクタリスティックノート）を持ち、独自の雰囲気を表現できる。モーダルインターチェンジ（借用和音）の理論的基盤。

## 構造
Cメジャースケールを基準にした7つのモード:
1. イオニアン（C起点）: C D E F G A B — メジャースケールと同一。明るく安定
2. ドリアン（D起点）: D E F G A B C — マイナー系だが明るい長6度を持つ
3. フリジアン（E起点）: E F G A B C D — 短2度が特徴。エスニック・スパニッシュな響き
4. リディアン（F起点）: F G A B C D E — 増4度（#4）が特徴。浮遊感・きらめき
5. ミクソリディアン（G起点）: G A B C D E F — 短7度が特徴。ブルージー・ファンキー
6. エオリアン（A起点）: A B C D E F G — ナチュラルマイナーと同一
7. ロクリアン（B起点）: B C D E F G A — 減5度(b5)を持つ唯一のモード。不安定

## 具体例
各モードの特性音と用途:
- ドリアン: 長6度。ジャズのマイナーキーで最多使用（「So What」Miles Davis）
- フリジアン: 短2度。フラメンコ、メタル
- リディアン: 増4度。映画音楽の浮遊感（「E.T.」のテーマ）
- ミクソリディアン: 短7度。ロック・ファンクのリフ

## 実践のポイント
モードを理解すると「モーダルインターチェンジ」（同主調のモードからコードを借用する技法）が使えるようになる。例えばCメジャーキーの曲でCドリアン由来のFm（IVm）を使うと、切ない響きが得られる。これはJ-POPでも「サブドミナントマイナー」として頻出するテクニック。''',
        'related_slugs': ['major-scale', 'minor-scale', 'diatonic-chords', 'modal-interchange'],
    },

    # ===== 和音 (chord) =====
    {
        'title': 'トライアド',
        'slug': 'triad',
        'category': 'chord',
        'difficulty': 1,
        'tags': '三和音,メジャーコード,マイナーコード,ディミニッシュ,オーギュメント,triad',
        'summary': 'トライアド（三和音）は3つの音で構成される最も基本的な和音。メジャー・マイナー・ディミニッシュ・オーギュメントの4種類があり、すべてのコード理論の基礎となる。',
        'body': '''## 定義
トライアド（三和音）は、ルート・3度・5度の3音で構成される和音。3度と5度の音程の組み合わせにより、4種類のトライアドが生まれる。最もシンプルなコードであり、セブンスコードやテンションコードの基礎。

## 構造
4種類のトライアド:
- メジャートライアド(M): ルート + 長3度 + 完全5度（例: C = C-E-G）→ 明るい・安定
- マイナートライアド(m): ルート + 短3度 + 完全5度（例: Cm = C-Eb-G）→ 暗い・哀愁
- ディミニッシュトライアド(dim): ルート + 短3度 + 減5度（例: Cdim = C-Eb-Gb）→ 不安定・緊張
- オーギュメントトライアド(aug): ルート + 長3度 + 増5度（例: Caug = C-E-G#）→ 浮遊感・不安定

転回形:
- 基本形: ルートが最低音（C-E-G）
- 第1転回形: 3度が最低音（E-G-C）
- 第2転回形: 5度が最低音（G-C-E）

## 具体例
Cメジャーキーのダイアトニックトライアド:
I: C(M) / II: Dm(m) / III: Em(m) / IV: F(M) / V: G(M) / VI: Am(m) / VII: Bdim(dim)

## 実践のポイント
メジャーとマイナーの響きの違いは「3度」の音程（長3度 vs 短3度）で決まる。コード進行を分析する際、まずトライアドレベルで機能（トニック/サブドミナント/ドミナント）を把握し、そこからセブンスやテンションの付加を考えるのが効率的。''',
        'related_slugs': ['seventh-chords', 'diatonic-chords', 'interval-basics'],
    },
    {
        'title': 'セブンスコード',
        'slug': 'seventh-chords',
        'category': 'chord',
        'difficulty': 2,
        'tags': '四和音,七の和音,メジャーセブンス,マイナーセブンス,ドミナントセブンス,maj7,m7,7',
        'summary': 'セブンスコード（四和音）はトライアドに7度の音を加えた4音構成の和音。メジャーセブンス(おしゃれ)・マイナーセブンス(柔らかい)・ドミナントセブンス(解決を求める)など、コードの表現力が大幅に広がる。',
        'body': '''## 定義
セブンスコード（七の和音）は、トライアドに7度の音を加えた4音構成のコード。7度の種類（長7度/短7度）とトライアドの種類の組み合わせにより、複数のセブンスコードが存在する。ポップスやジャズの基本的なボイシング。

## 構造
主要なセブンスコード:
- メジャーセブンス(Cmaj7): C-E-G-B（メジャートライアド + 長7度）→ おしゃれ・都会的・開放的
- マイナーセブンス(Cm7): C-Eb-G-Bb（マイナートライアド + 短7度）→ 柔らかい・ジャジー
- ドミナントセブンス(C7): C-E-G-Bb（メジャートライアド + 短7度）→ 不安定・解決を求める
- マイナーセブンフラットファイブ(Cm7b5): C-Eb-Gb-Bb（ディミニッシュトライアド + 短7度）→ ハーフディミニッシュ
- ディミニッシュセブンス(Cdim7): C-Eb-Gb-Bbb(=A)（ディミニッシュトライアド + 減7度）→ 強い緊張感

## 具体例
Cメジャーキーのダイアトニックセブンスコード:
Imaj7: Cmaj7 / IIm7: Dm7 / IIIm7: Em7 / IVmaj7: Fmaj7 / V7: G7 / VIm7: Am7 / VIIm7b5: Bm7b5

Aマイナーキーのダイアトニックセブンスコード:
Im7: Am7 / IIm7b5: Bm7b5 / bIIImaj7: Cmaj7 / IVm7: Dm7 / Vm7: Em7 / bVImaj7: Fmaj7 / bVII7: G7

## 実践のポイント
ドミナントセブンス(V7)はトライトーン（増4度/減5度）を含み、トニックへの強い解決力を持つ。これがII-V-I進行の「V→I」の推進力の源。ポップスではmaj7やm7を使うだけで一気におしゃれな響きになる。''',
        'related_slugs': ['triad', 'tension-chords', 'two-five-one', 'diatonic-chords'],
    },
    {
        'title': 'テンションコード',
        'slug': 'tension-chords',
        'category': 'chord',
        'difficulty': 4,
        'tags': 'テンション,9th,11th,13th,ナインス,イレブンス,サーティーンス,アヴォイドノート,テンションノート',
        'summary': 'テンションコードはセブンスコードに9度・11度・13度を加えた和音。ナチュラルテンションとオルタードテンションがあり、アヴォイドノートの概念と合わせて理解することで、洗練されたサウンドを構築できる。',
        'body': '''## 定義
テンションコードは、セブンスコード（4和音）にさらに9度(9th)・11度(11th)・13度(13th)の音を加えたコード。テンション（緊張）を加えることで、より豊かで複雑な響きを生む。ダイアトニックスケール上のテンション（ナチュラルテンション）と、変化させたテンション（オルタードテンション）がある。

## 構造
ナチュラルテンション:
- 9th: スケールの2度をオクターブ上で付加
- 11th: スケールの4度をオクターブ上で付加
- 13th: スケールの6度をオクターブ上で付加

オルタードテンション（主にドミナント7thで使用）:
- b9, #9: 変化した9度
- #11: 増11度
- b13: 短13度

アヴォイドノート: コードトーンと短9度（半音）の関係になり、コードの響きを濁らせるテンション
- Cmaj7のアヴォイド: 11th(F)（Eと半音でぶつかる）
- Dm7のアヴォイド: 13th(B)... ではなくアヴォイドなし（諸説あり）

## 具体例
よく使われるテンションコード:
- Cmaj9 = Cmaj7 + 9th(D): おしゃれで広がりのある響き
- Dm9 = Dm7 + 9th(E): ボサノバ・シティポップで頻出
- G7(b9,b13): ジャズのオルタードドミナント
- Fmaj7(#11): リディアンサウンドの浮遊感
- C7(#9): ジミヘンコード。ブルージーかつアグレッシブ

## 実践のポイント
テンションは「セブンスコードの上に積む」ものであり、3度と7度がコードの性格を決定する。テンションはその性格に「色」を加える役割。まずはadd9（セブンス抜きで9thを加える）やmaj9など、ナチュラルテンションから始めると理解しやすい。''',
        'related_slugs': ['seventh-chords', 'diatonic-chords', 'two-five-one'],
    },
    {
        'title': 'パワーコード',
        'slug': 'power-chord',
        'category': 'chord',
        'difficulty': 1,
        'tags': 'パワーコード,5度,ルートと5度,ロック,パンク,ディストーション,power chord,5th',
        'summary': 'パワーコードはルートと完全5度の2音で構成されるシンプルなコード。3度を含まないためメジャー/マイナーの区別がなく、ディストーションとの相性が抜群。ロック・パンクの基本。',
        'body': '''## 定義
パワーコード（5度コード）は、ルート音と完全5度の2音で構成されるコード。正式には3度を含まないため「和音」ではなく「音程」だが、ロックやパンクで広く使われるためパワーコードと呼ばれる。3度の音がないため、メジャーでもマイナーでもない中性的な響き。

## 構造
C5（Cパワーコード）: C - G（ルート + 完全5度）
実際の演奏では C - G - C（オクターブを加える）ことも多い。

特徴:
- 3度を含まない → メジャー/マイナーの曖昧さ
- ディストーションをかけても音が濁りにくい（倍音の干渉が少ない）
- オクターブを加えた3音で演奏するのが一般的

## 具体例
ロックの定番リフ:
- E5 - G5 - A5 - E5: ロックンロールの基本パターン
- 代表曲: 「Smells Like Teen Spirit」Nirvana, 「Smoke on the Water」Deep Purple

パワーコードが効果的な場面:
- 歪んだサウンドでのバッキング
- ヘヴィなリフの構築
- メジャー/マイナーを意図的に曖昧にしたい場合

## 実践のポイント
パワーコードはシンプルだからこそ、リズムやミュートの精度がサウンドの質を左右する。ブリッジミュートとの組み合わせ、刻みのリズムパターンの変化で多彩な表現が可能。3度を含むコードとの使い分けを意識すると、アレンジの幅が広がる。''',
        'related_slugs': ['triad', 'interval-basics'],
    },
    {
        'title': '分数コード',
        'slug': 'slash-chord',
        'category': 'chord',
        'difficulty': 3,
        'tags': '分数コード,オンコード,スラッシュコード,転回形,ペダルポイント,slash chord,on chord',
        'summary': '分数コード（オンコード）は、コードの最低音を指定する記法。C/Eのように「コード/ベース音」で表す。転回形の指定、ベースラインの滑らかな動き、ペダルポイントなど多彩な用途がある。',
        'body': '''## 定義
分数コード（スラッシュコード/オンコード）は、コードネームの右に「/ベース音」を付記してベース音を指定するコード。C/E は「Cコードでベース音がE」の意味。転回形の一種だが、コード構成音以外の音をベースにする場合もある。

## 構造
主な用途:
1. 転回形: コード構成音をベースにする
   - C/E（第1転回形）: ベースE + C-G（ベースラインを滑らかに）
   - C/G（第2転回形）: ベースG + C-E

2. 非和声音ベース: コードにない音をベースにする
   - C/Bb: CコードにBbベース → 実質C7の転回形的響き
   - Am/G: Amの上にGベース → Am7の転回形

3. ペダルポイント: ベース音を固定したまま上のコードが動く
   - C/G → D/G → Em/G → F/G: Gペダル上でコードが進行

## 具体例
クリシェ（半音進行）での使用:
- C → C/B → C/Bb → C/A → ... : ベースが半音ずつ下降
- Am → Am/G# → Am/G → Am/F#: マイナークリシェ

J-POPでの頻出パターン:
- IV/V → V → I: サビの直前で使われる（例: F/G → G → C）
- IVmaj7 → IIIm/V → ... : ベースラインの順次下降

## 実践のポイント
分数コードの本質は「ベースラインのコントロール」。コード進行を作る際、上のコード（ハーモニー）とベースライン（低音の動き）を別々に考えると、分数コードの使いどころが見えてくる。特にベースの半音・全音の順次進行はプロの編曲で多用される。''',
        'related_slugs': ['triad', 'seventh-chords', 'canon-progression', 'secondary-dominant'],
    },

    # ===== コード進行 (progression) =====
    {
        'title': 'ダイアトニックコード',
        'slug': 'diatonic-chords',
        'category': 'progression',
        'difficulty': 2,
        'tags': 'ダイアトニック,スケール上の和音,トニック,サブドミナント,ドミナント,機能和声,T,SD,D,ディグリーネーム',
        'summary': 'ダイアトニックコードは、1つのスケール上の音だけで作られるコードの集合。メジャーキーでは7つのコードが生まれ、トニック(安定)・サブドミナント(やや不安定)・ドミナント(不安定)の3つの機能に分類される。',
        'body': '''## 定義
ダイアトニックコードは、特定のスケール（音階）の構成音のみを使って3度ずつ積み重ねて作られるコード群。メジャースケール上に7つ、マイナースケール上に7つのダイアトニックコードが存在する。コード進行の理論的基盤。

## 構造
■ メジャーキーのダイアトニックコード

三和音:
I(M) / IIm / IIIm / IV(M) / V(M) / VIm / VIIdim

四和音（セブンス）:
Imaj7 / IIm7 / IIIm7 / IVmaj7 / V7 / VIm7 / VIIm7b5

機能分類:
- トニック(T): I, IIIm, VIm — 安定・終止感
- サブドミナント(SD): II, IV — やや不安定・展開感
- ドミナント(D): V, VIIdim — 不安定・解決を求める

■ 各キーのダイアトニックコード（三和音）
- C: C / Dm / Em / F / G / Am / Bdim
- G: G / Am / Bm / C / D / Em / F#dim
- D: D / Em / F#m / G / A / Bm / C#dim
- A: A / Bm / C#m / D / E / F#m / G#dim
- E: E / F#m / G#m / A / B / C#m / D#dim
- F: F / Gm / Am / Bb / C / Dm / Edim
- Bb: Bb / Cm / Dm / Eb / F / Gm / Adim
- Eb: Eb / Fm / Gm / Ab / Bb / Cm / Ddim

## 具体例
基本的なコード進行はダイアトニックコードの組み合わせ:
- I-V-VIm-IV (C-G-Am-F): Let It Be進行
- IV-V-IIIm-VIm (F-G-Em-Am): 王道進行
- VIm-IV-V-I (Am-F-G-C): 小室進行
- I-IV-V-I (C-F-G-C): 最も基本的なカデンツ

## 実践のポイント
ディグリーネーム（ローマ数字）で覚えることが最重要。ディグリーで把握すれば、キーが変わっても同じ感覚でコード進行を分析・構築できる。まずCメジャーとAマイナーのダイアトニックコードを完全に暗記し、五度圏に沿って他のキーに展開する。''',
        'related_slugs': ['triad', 'seventh-chords', 'major-scale', 'canon-progression', 'komuro-progression', 'oudou-progression', 'secondary-dominant', 'modal-interchange'],
    },
    {
        'title': 'カノン進行',
        'slug': 'canon-progression',
        'category': 'progression',
        'difficulty': 2,
        'tags': 'カノン進行,パッヘルベル,I-V-VIm-IIIm-IV-I-IV-V,下降ベースライン,定番進行',
        'summary': 'カノン進行はパッヘルベルの「カノン」に由来する、ベースラインが順次下降する美しいコード進行。I-V-VIm-IIIm-IV-I-IV-Vの循環で、J-POPの名曲に数多く使われている。',
        'body': '''## 定義
カノン進行は、ヨハン・パッヘルベルの「カノン ニ長調」で使われたコード進行をベースにしたもの。ベースラインがスケールに沿って順次下降していく特徴があり、自然で心地よい流れを生む。

## 構造
基本形:
I - V - VIm - IIIm - IV - I - IV - V

ベースラインの動き:
1 → 7 → 6 → 5 → 4 → 3 → 4 → 5
（ド → シ → ラ → ソ → ファ → ミ → ファ → ソ）

■ 各キーでのカノン進行
- C: C → G → Am → Em → F → C → F → G
- G: G → D → Em → Bm → C → G → C → D
- D: D → A → Bm → F#m → G → D → G → A
- A: A → E → F#m → C#m → D → A → D → E
- F: F → C → Dm → Am → Bb → F → Bb → C
- Bb: Bb → F → Gm → Dm → Eb → Bb → Eb → F
- Eb: Eb → Bb → Cm → Gm → Ab → Eb → Ab → Bb

## 具体例
カノン進行を使った有名なJ-POP:
- 「愛をこめて花束を」Superfly
- 「さくら」森山直太朗
- 「Butterfly」木村カエラ
- 「負けないで」ZARD
- 洋楽: 「Let It Be」Beatles, 「Don't Look Back In Anger」Oasis

## 実践のポイント
カノン進行の魅力はベースラインの下降にある。そのまま使うとありきたりに感じられる場合は、一部をセブンスコードにしたり（Imaj7-V-VIm7-IIIm7...）、分数コードでベースラインをさらに滑らかにしたり（C-G/B-Am-Em/G-F-C/E-Dm-G）するとオリジナリティが出る。''',
        'related_slugs': ['diatonic-chords', 'komuro-progression', 'oudou-progression', 'two-five-one', 'slash-chord'],
    },
    {
        'title': '小室進行',
        'slug': 'komuro-progression',
        'category': 'progression',
        'difficulty': 2,
        'tags': '小室進行,小室哲哉,VIm-IV-V-I,6451,90年代,哀愁,マイナーから始まる',
        'summary': '小室進行（VIm-IV-V-I）は小室哲哉が多用したことで知られるコード進行。マイナーコードから始まることで哀愁感があり、J-POP・アニソンで最も広く使われる定番進行の一つ。',
        'body': '''## 定義
小室進行は VIm-IV-V-I のコード進行で、プロデューサー小室哲哉が90年代のヒット曲で多用したことからこの名がある。マイナーコード始まりの哀愁感と、V→Iの解決感が特徴で、ループさせやすくキャッチー。

## 構造
基本形:
VIm - IV - V - I

特徴:
- マイナーコード（VIm）から始まるため、メジャーキーでも切なさがある
- IV→V→Iのサブドミナント→ドミナント→トニックが強い推進力を持つ
- ループ可能で、Aメロ〜サビまで同じ進行で成立する
- マイナーキーの視点で見ると Im-bVI-bVII-bIII（マイナーキーの1-6-7-3）

■ 各キーでの小室進行
- C: Am → F → G → C
- G: Em → C → D → G
- D: Bm → G → A → D
- A: F#m → D → E → A
- E: C#m → A → B → E
- F: Dm → Bb → C → F
- Bb: Gm → Eb → F → Bb
- Eb: Cm → Ab → Bb → Eb

## 具体例
小室進行を使った代表曲:
- 「Get Wild」TM NETWORK
- 「残酷な天使のテーゼ」高橋洋子
- 「夜に駆ける」YOASOBI
- 「丸の内サディスティック」椎名林檎（変形）
- 「紅蓮華」LiSA

## 実践のポイント
作曲初心者が最初に覚えるべき進行の1つ。バリエーションとして、IVをIVm（サブドミナントマイナー）に置き換えると切なさが増す。テンポやメロディ・リズムパターンを変えるだけで全く異なる曲に仕上がる。セブンスに展開すると VIm7-IVmaj7-V7-Imaj7 となり、より洗練された響きに。''',
        'related_slugs': ['diatonic-chords', 'canon-progression', 'oudou-progression', 'modal-interchange'],
    },
    {
        'title': 'ツーファイブワン',
        'slug': 'two-five-one',
        'category': 'progression',
        'difficulty': 3,
        'tags': 'ツーファイブワン,II-V-I,2-5-1,ジャズ,ドミナントモーション,解決,カデンツ',
        'summary': 'ツーファイブワン（II-V-I）はジャズの最重要コード進行。サブドミナント→ドミナント→トニックの流れで最も強い終止感（解決感）を持つ。J-POPでも転調や部分的な借用で多用される。',
        'body': '''## 定義
ツーファイブワン（II-V-I）は、ダイアトニックコードのII度→V度→I度の進行。機能和声におけるサブドミナント(SD)→ドミナント(D)→トニック(T)の最も基本的な流れで、調性音楽における最強の終止形。

## 構造
メジャーキーの場合:
IIm7 → V7 → Imaj7

マイナーキーの場合:
IIm7b5 → V7 → Im7（V7はハーモニックマイナー由来）

■ 各キーのツーファイブワン（メジャー）
- C: Dm7 → G7 → Cmaj7
- G: Am7 → D7 → Gmaj7
- D: Em7 → A7 → Dmaj7
- A: Bm7 → E7 → Amaj7
- E: F#m7 → B7 → Emaj7
- F: Gm7 → C7 → Fmaj7
- Bb: Cm7 → F7 → Bbmaj7
- Eb: Fm7 → Bb7 → Ebmaj7

■ 各キーのツーファイブワン（マイナー）
- Am: Bm7b5 → E7 → Am7
- Em: F#m7b5 → B7 → Em7
- Dm: Em7b5 → A7 → Dm7

裏コード: V7の代わりにbII7を使用（トライトーン・サブスティテューション）
例: Dm7 → Db7 → Cmaj7（G7の代わりにDb7）

## 具体例
ジャズスタンダードでの使用:
- 「Fly Me to the Moon」: Am7-Dm7-G7-Cmaj7（VIm7-IIm7-V7-Imaj7）
- 「Autumn Leaves」: II-V-Iの連続転調で構成

J-POPでの部分使用:
- サビ前やサビ終わりで IIm7-V7-I を使って着地感を出す
- セカンダリードミナント経由のII-V: IIm7-V7/VI → VIm（部分転調）

## 実践のポイント
II-V-Iを全12キーで即座に弾ける/歌えるようにすることが、コード理論の実践力を飛躍的に高める。五度圏（C→F→Bb→Eb...）の順で練習すると、すべてのキーを網羅できる。''',
        'related_slugs': ['seventh-chords', 'diatonic-chords', 'tension-chords', 'key-modulation', 'secondary-dominant'],
    },
    {
        'title': '王道進行',
        'slug': 'oudou-progression',
        'category': 'progression',
        'difficulty': 1,
        'tags': '王道進行,IV-V-IIIm-VIm,4536,J-POP,サビ,定番',
        'summary': '王道進行（IV-V-IIIm-VIm）はJ-POPのサビで最も多く使われるコード進行。サブドミナントから始まり、偽終止でマイナーに解決する流れが、切なくもドラマティックな展開を生む。',
        'body': '''## 定義
王道進行は IV-V-IIIm-VIm のコード進行で、J-POPのサビ（特に90年代〜2000年代）で圧倒的に多用される。「4536進行」とも呼ばれる。サブドミナント始まりの推進力と、偽終止（V→VIm, Iに行かずVImに解決）の切なさが特徴。

## 構造
基本形:
IV - V - IIIm - VIm

特徴:
- IV→Vで盛り上がり（サブドミナント→ドミナント）
- V→IIIm（偽終止の変形）で切ない裏切り
- IIIm→VImの下降3度進行が自然な流れ
- ループ可能で、繰り返すだけでサビが成立

■ 各キーでの王道進行
- C: F → G → Em → Am
- G: C → D → Bm → Em
- D: G → A → F#m → Bm
- A: D → E → C#m → F#m
- E: A → B → G#m → C#m
- F: Bb → C → Am → Dm
- Bb: Eb → F → Dm → Gm
- Eb: Ab → Bb → Gm → Cm

## 具体例
王道進行を使った代表曲:
- 「小さな恋のうた」MONGOL800
- 「天体観測」BUMP OF CHICKEN
- 「世界に一つだけの花」SMAP
- 「紅蓮華」LiSA
- 「LOVEマシーン」モーニング娘。

## 実践のポイント
セブンスに展開すると IVmaj7-V7-IIIm7-VIm7 でより洗練される。IIImをIII7にするとセカンダリードミナント（VImへのV7）となり、VImへの解決感が強まる。分数コードでベースラインを工夫する（IV-V/IV#-IIIm-...）のも効果的。''',
        'related_slugs': ['diatonic-chords', 'canon-progression', 'komuro-progression', 'secondary-dominant'],
    },
    {
        'title': 'セカンダリードミナント',
        'slug': 'secondary-dominant',
        'category': 'progression',
        'difficulty': 3,
        'tags': 'セカンダリードミナント,副属七,ノンダイアトニックコード,V7/V,ドミナントモーション,二次ドミナント',
        'summary': 'セカンダリードミナントは、ダイアトニックコード以外のV7を一時的に借用するテクニック。各コードの「仮のV7」を挿入することで、コード進行に強い推進力と色彩を加える。ノンダイアトニックコードの最初の一歩。',
        'body': '''## 定義
セカンダリードミナント（副属七の和音）は、ダイアトニックコードの各コードに対して、あたかもそのコードが一時的にI（トニック）であるかのように、V7の関係にあるコードを挿入する技法。一時的な転調（トニシゼーション）を生む。

## 構造
Cメジャーキーでのセカンダリードミナント:
- V7/II = A7 → Dm（Dmへの仮のV7）
- V7/III = B7 → Em（Emへの仮のV7）
- V7/IV = C7 → F（Fへの仮のV7）
- V7/V = D7 → G（Gへの仮のV7）
- V7/VI = E7 → Am（Amへの仮のV7）

※V7/VIIdimは実用上ほとんど使われない（解決先が不安定なため）

セカンダリードミナントの前にII度を付ける「セカンダリーII-V」:
- IIm7/V - V7/V → V = Am7 - D7 → G（Gに向かうII-V）

## 具体例
J-POPでの頻出例:
- C → E7 → Am: V7/VIの使用。Amへの解決が強くなる
- C → A7 → Dm → G7: V7/IIの使用。Dmへの推進力
- F → G → E7 → Am: 王道進行のIIImをIII7（=V7/VI）にした変形

■ 各キーでの V7/VI（最頻出）
- C: E7 → Am
- G: B7 → Em
- D: F#7 → Bm
- A: C#7 → F#m
- F: A7 → Dm

## 実践のポイント
セカンダリードミナントは「次のコードの完全5度上にあるドミナント7thコード」と覚える。ダイアトニック進行に1つ挿入するだけで、プロっぽい「動き」が生まれる。特にV7/VIは王道進行でIIImの代わりに使える最も実用的なセカンダリードミナント。''',
        'related_slugs': ['diatonic-chords', 'two-five-one', 'seventh-chords', 'oudou-progression', 'key-modulation'],
    },
    {
        'title': 'モーダルインターチェンジ',
        'slug': 'modal-interchange',
        'category': 'progression',
        'difficulty': 3,
        'tags': 'モーダルインターチェンジ,借用和音,サブドミナントマイナー,同主調,ノンダイアトニック,modal interchange',
        'summary': 'モーダルインターチェンジ（借用和音）は同主調の他のモードからコードを借りてくる技法。最も有名なのはサブドミナントマイナー（IVm）で、メジャーキーに切なさを加えるJ-POPの定番テクニック。',
        'body': '''## 定義
モーダルインターチェンジ（借用和音）は、同じ主音を持つ他のモード（同主調）からコードを借用する技法。例えばCメジャーキーの曲で、Cマイナー（エオリアン）やCドリアンなどからコードを借りてくる。ノンダイアトニックコードの主要な供給源。

## 構造
Cメジャーキーでの主要な借用コード:

Cナチュラルマイナー（エオリアン）からの借用:
- IVm (Fm): サブドミナントマイナー。最も頻出
- bVII (Bb): ロック・ポップスで多用
- bVI (Ab): ドラマティックな響き
- bIII (Eb): 浮遊感

Cドリアンからの借用:
- IVm (Fm) + IIm (Dm): ドリアンではIIがマイナーのまま

Cリディアンからの借用:
- #IVdim: リディアン由来の増4度

■ 各キーでのサブドミナントマイナー（IVm）
- C: Fm
- G: Cm
- D: Gm
- A: Dm
- E: Am
- F: Bbm
- Bb: Ebm

## 具体例
J-POPで頻出するモーダルインターチェンジ:
- C → F → Fm → C: サブドミナントマイナーの典型。IV→IVmの流れが切ない
- C → Ab → Bb → C: bVI-bVII-Iの進行。ロック的なダイナミズム
- Am → F → G → Ab → Bb → C: bVI-bVIIを経由してIに解決

サブドミナントマイナーを使った名曲:
- 多くのバラードのサビ終わりで IV→IVm→I の流れが使われる

## 実践のポイント
まずはサブドミナントマイナー（IVm）の使い方をマスターすることが最優先。IV→IVm→Iの流れはどんなメジャーキーの曲にも応用でき、切ない余韻を加えられる。次にbVII、bVIと覚えていくと、ノンダイアトニックコードの語彙が広がる。''',
        'related_slugs': ['diatonic-chords', 'church-modes', 'komuro-progression', 'key-modulation'],
    },

    # ===== 音程 (interval) =====
    {
        'title': '音程の基礎',
        'slug': 'interval-basics',
        'category': 'interval',
        'difficulty': 1,
        'tags': '音程,インターバル,度数,半音,全音,interval',
        'summary': '音程（インターバル）は2つの音の距離を表す。半音・全音を基本単位とし、度数（1度〜8度）で表記する。コード構成やスケール理解の前提となる最も基礎的な概念。',
        'body': '''## 定義
音程（インターバル）とは、2つの音の高さの隔たりを数値で表したもの。西洋音楽では半音を最小単位とし、度数（1度、2度、3度...）で表す。同時に鳴らす場合を和声的音程、順番に鳴らす場合を旋律的音程と呼ぶ。

## 構造
半音の数と度数の対応:
- 0半音: 完全1度（ユニゾン）
- 1半音: 短2度
- 2半音: 長2度（全音）
- 3半音: 短3度 → マイナーコードの「暗さ」の源
- 4半音: 長3度 → メジャーコードの「明るさ」の源
- 5半音: 完全4度
- 6半音: 増4度/減5度（トライトーン）→ 最も不安定な音程
- 7半音: 完全5度 → パワーコードの響き
- 8半音: 短6度
- 9半音: 長6度
- 10半音: 短7度
- 11半音: 長7度
- 12半音: 完全8度（オクターブ）

## 具体例
身近な曲の冒頭で音程を覚える方法:
- 短2度: 「ジョーズ」のテーマ（半音の動き）
- 長2度: 「きらきら星」の冒頭（ド→レ）
- 短3度: 「グリーンスリーブス」の冒頭
- 完全4度: 「蛍の光」の冒頭（ソ→ド）
- 完全5度: 「スターウォーズ」のテーマ冒頭
- オクターブ: 「Over the Rainbow」の冒頭

## 実践のポイント
音程はコード構成音の理解に直結する。「メジャーコード = ルート+長3度+完全5度」「マイナーコード = ルート+短3度+完全5度」と定義されるため、音程がわからなければコードを理解できない。まず完全音程（1,4,5,8度）と長短3度を聴き分けることから始める。''',
        'related_slugs': ['perfect-intervals', 'triad', 'major-scale'],
    },
    {
        'title': '完全音程と長短音程',
        'slug': 'perfect-intervals',
        'category': 'interval',
        'difficulty': 2,
        'tags': '完全音程,長音程,短音程,増音程,減音程,トライトーン,完全4度,完全5度',
        'summary': '音程は「完全系」と「長短系」の2グループに分かれる。完全系（1・4・5・8度）は増減で変化し、長短系（2・3・6・7度）は長→短→減と変化する。この区別がスケールやコード構築の基本原理。',
        'body': '''## 定義
音程は「完全系」と「長短系」の2つのグループに分類される。完全系は完全音程を基準に増・減で変化し、長短系は長音程を基準に短→減と狭まる。この区別はメジャースケールの各音とルートの関係から導かれる。

## 構造
完全系（1度, 4度, 5度, 8度）:
減 ← 完全 → 増
（半音狭い ← 基準 → 半音広い）

長短系（2度, 3度, 6度, 7度）:
減 ← 短 ← 長 → 増
（さらに半音狭い ← 半音狭い ← 基準 → 半音広い）

メジャースケールの各音との関係（すべて完全/長音程）:
1度=完全, 2度=長, 3度=長, 4度=完全, 5度=完全, 6度=長, 7度=長

マイナースケールとの違い:
3度=短, 6度=短, 7度=短 → これがマイナーの「暗さ」の正体

## 具体例
重要な音程とその役割:
- 完全5度(C→G): 最も協和する音程。パワーコード・ハーモニーの基盤
- 増4度/減5度(C→F#/Gb): トライトーン。ドミナント7thの不安定さの源。V7→Iの解決の原動力
- 長3度(C→E): メジャーコードの明るさ。長3度+完全5度=メジャートライアド
- 短3度(C→Eb): マイナーコードの暗さ。短3度+完全5度=マイナートライアド
- 長7度(C→B): メジャーセブンスの洗練された響き
- 短7度(C→Bb): ドミナントセブンス、マイナーセブンスに使用

## 実践のポイント
トライトーン（増4度/減5度 = 6半音）はコード理論の核心。ドミナントセブンスコード内の3度と7度がトライトーンの関係にあり、これが解決を求める力（ドミナントモーション）を生む。例: G7のB(3度)とF(7度)はトライトーンで、C(トニック)のE(3度)とC(ルート)に解決する。''',
        'related_slugs': ['interval-basics', 'triad', 'seventh-chords'],
    },

    # ===== 調 (key) =====
    {
        'title': '調と調号',
        'slug': 'key-signature',
        'category': 'key',
        'difficulty': 2,
        'tags': '調,調号,キー,シャープ,フラット,長調,短調,平行調,五度圏,key signature',
        'summary': '調（キー）は楽曲の音階的中心を示し、調号（シャープ/フラットの数）で表される。五度圏で全調の関係を把握でき、長調と短調が対になる平行調、同じ主音を持つ同主調の概念が重要。',
        'body': '''## 定義
調（キー）は楽曲が基盤とするスケール（音階）とその中心音（主音）を指す。調号はその調で常に変化する音を五線の最初にまとめて記したもの。シャープ系とフラット系に分かれる。

## 構造
■ 五度圏（Circle of Fifths）

シャープ系（5度上に進む）:
♯0: C / Am
♯1: G / Em（F#）
♯2: D / Bm（F#, C#）
♯3: A / F#m（F#, C#, G#）
♯4: E / C#m（F#, C#, G#, D#）
♯5: B / G#m（F#, C#, G#, D#, A#）

フラット系（4度上/5度下に進む）:
♭1: F / Dm（Bb）
♭2: Bb / Gm（Bb, Eb）
♭3: Eb / Cm（Bb, Eb, Ab）
♭4: Ab / Fm（Bb, Eb, Ab, Db）
♭5: Db / Bbm（Bb, Eb, Ab, Db, Gb）

■ 重要な関係
- 平行調: 同じ調号を持つ長調と短調（例: CメジャーとAマイナー）
- 同主調: 同じ主音の長調と短調（例: CメジャーとCマイナー）
- 属調: 5度上の調（Cから見てG。♯が1つ増える）
- 下属調: 4度上の調（Cから見てF。♭が1つ増える）

## 具体例
J-POPで多い調:
- C/Am: 調号なし。ピアノで弾きやすい
- G/Em: ♯1つ。アコースティックギターと相性が良い
- D/Bm: ♯2つ。ギターのカポと相性が良い
- A/F#m: ♯3つ。ポップスで人気
- F/Dm: ♭1つ。管楽器との相性が良い

## 実践のポイント
五度圏を覚えることが最優先。「シャープの増える順: F-C-G-D-A-E-B」「フラットの増える順: B-E-A-D-G-C-F」（シャープの逆順）。調号がわかればダイアトニックコードがすべて導けるため、五度圏は音楽理論の「地図」と言える。''',
        'related_slugs': ['major-scale', 'minor-scale', 'key-modulation', 'diatonic-chords'],
    },
    {
        'title': '近親調と転調',
        'slug': 'key-modulation',
        'category': 'key',
        'difficulty': 3,
        'tags': '転調,近親調,属調,下属調,平行調,同主調,モジュレーション,ピボットコード,半音上げ転調',
        'summary': '転調は楽曲の途中で調（キー）を変えること。近親調（属調・下属調・平行調・同主調）への転調は自然で、J-POPのサビやラスサビで多用される。ピボットコードやセカンダリードミナントが転調の鍵。',
        'body': '''## 定義
転調（モジュレーション）は楽曲内でキーを変更すること。近親調とは元の調から見て関係の近い調で、共通するコードが多いため自然な転調がしやすい。遠隔調への転調はドラマティックな効果がある。

## 構造
Cメジャーの近親調:
- 属調: Gメジャー（5度上。♯が1つ増える）
- 下属調: Fメジャー（4度上。♭が1つ増える）
- 平行調: Aマイナー（同じ調号の短調）
- 同主調: Cマイナー（同じ主音の短調）

転調の手法:
1. ピボットコード転調: 両方の調に共通するコードを経由点にする
   例: CメジャーのIV(F) = FメジャーのI(F) を経由してFメジャーへ
2. セカンダリードミナント転調: 転調先のV7を挿入して強制的に解決
   例: C → D7 → G（D7がGメジャーへのV7）
3. 直接転調: 準備なしに突然キーを変える
   例: ラスサビでの半音上げ転調
4. 同主調転調: メジャー↔マイナーの切り替え

## 具体例
J-POPでの転調パターン:
- ラスサビ半音上げ: C→Dbへ直接転調。盛り上がりの定番
- サビで平行調: Aメロ(Am) → サビ(C) で平行調に転調。暗→明の対比
- Bメロで下属調: Bメロで下属調に寄り道してサビに戻る
- サビ前の全音上げ転調: C→D。曲全体が明るく開ける

■ 半音上げ転調の各キー
- C→Db, D→Eb, E→F, F→Gb(F#), G→Ab, A→Bb, B→C

## 実践のポイント
最も自然な転調は平行調・属調への移行。ラスサビの半音上げは効果的だが、使い所を選ぶ。転調の前にセカンダリードミナントやII-Vを1小節挿入するだけで、唐突さを和らげ自然な流れにできる。''',
        'related_slugs': ['key-signature', 'diatonic-chords', 'two-five-one', 'secondary-dominant'],
    },

    # ===== リズム (rhythm) =====
    {
        'title': '拍子と拍',
        'slug': 'time-signature',
        'category': 'rhythm',
        'difficulty': 1,
        'tags': '拍子,拍,4分の4拍子,4/4,3/4,6/8,強拍,弱拍,小節,time signature',
        'summary': '拍子は音楽のリズムの基本的な枠組み。4/4拍子が最も一般的で、強拍と弱拍の繰り返しがグルーヴを生む。3/4拍子（ワルツ）や6/8拍子など、拍子の違いで曲の雰囲気が大きく変わる。',
        'body': '''## 定義
拍子（タイムシグネチャー）は、小節内の拍の数とその基準となる音符の種類を示す。分数のような表記で、分母が基準音符、分子が1小節あたりの拍数を表す。強拍（アクセント）と弱拍のパターンが拍子を特徴づける。

## 構造
主な拍子:
- 4/4拍子: 1小節に4分音符4つ。強-弱-中強-弱。ポップス・ロックの大半
- 3/4拍子: 1小節に4分音符3つ。強-弱-弱。ワルツのリズム
- 2/4拍子: 1小節に4分音符2つ。強-弱。マーチ
- 6/8拍子: 1小節に8分音符6つ（2拍子系）。強-弱-弱-中強-弱-弱。バラードに多い
- 変拍子: 5/4, 7/8 など。プログレッシブロック・ジャズで使用

単純拍子と複合拍子:
- 単純拍子: 各拍が2分割（4/4, 3/4, 2/4）
- 複合拍子: 各拍が3分割（6/8, 9/8, 12/8）

## 具体例
- 4/4拍子: ほとんどのポップス、ロック、R&B、EDM
- 3/4拍子: ワルツ、「ジムノペディ」（サティ）
- 6/8拍子: 「We Are the Champions」Queen、多くのバラード
- 5/4拍子: 「Take Five」Dave Brubeck
- 7/8拍子: 「Money」Pink Floyd

## 実践のポイント
4/4拍子では2拍目と4拍目にスネア（バックビート）が入ることが多い。この「裏」の感覚を身につけることでグルーヴのある音楽制作ができる。拍子の選択は作曲の最初の決定事項であり、3/4を選ぶだけでワルツ風に、6/8を選ぶだけでバラード風になる。''',
        'related_slugs': ['syncopation', 'shuffle-swing'],
    },
    {
        'title': 'シンコペーション',
        'slug': 'syncopation',
        'category': 'rhythm',
        'difficulty': 2,
        'tags': 'シンコペーション,リズムのずらし,裏拍,アクセント移動,食い,syncopation',
        'summary': 'シンコペーションは、通常の強拍以外の位置にアクセントを置くリズム技法。「食い」とも呼ばれ、リズムに躍動感と意外性を与える。ファンク・R&B・J-POPで不可欠なリズム要素。',
        'body': '''## 定義
シンコペーションは、本来弱拍にあたる位置にアクセント（強勢）を置いたり、強拍の音を裏拍からタイでつないだりすることで、リズムの予想を裏切る効果を生む技法。日本の音楽用語では「食い」とも呼ばれる。

## 構造
基本パターン:
- 裏拍アクセント: 4/4拍子の「と」（8分音符の裏）にアクセント
- タイによるシンコペーション: 弱拍の音を次の強拍にタイでつなぐ
- 食い: メロディやコードチェンジを拍の少し前（裏拍）から入れる
- 先取音: 次の小節のコードを前の小節の最後で先に鳴らす

記譜例（4/4拍子、x=アクセント）:
通常:   x - - -  x - - -  x - - -  x - - -  （拍の頭にアクセント）
シンコペ: - x - -  - x - -  - x - -  - x - -  （裏拍にアクセント）

## 具体例
- ファンク: James Brownの楽曲。「1拍目」のアクセントが特に重要
- ボサノバ: 右手のシンコペーションパターンが特徴的
- レゲエ: オフビート（裏拍）のコードカッティング
- J-POP: サビのメロディが小節線の前から「食って」入るパターンは非常に多い
- EDM: キック(強拍)とオフビートハイハット(裏拍)の組み合わせ

## 実践のポイント
シンコペーションはリズムの「ノリ」の核心。DTMでは、MIDIノートを16分音符分前にずらすだけでシンコペーション（食い）が作れる。メロディの歌い出しを拍の裏に置くだけでも、格段にプロっぽいリズム感が出る。まずは既存曲でシンコペーションの箇所を意識して聴く練習が効果的。''',
        'related_slugs': ['time-signature', 'shuffle-swing'],
    },
    {
        'title': 'シャッフルとスウィング',
        'slug': 'shuffle-swing',
        'category': 'rhythm',
        'difficulty': 2,
        'tags': 'シャッフル,スウィング,ハネるリズム,三連符,バウンス,ブルース,shuffle,swing',
        'summary': 'シャッフル/スウィングは8分音符を均等ではなく「ハネた」リズムで演奏するスタイル。三連符ベースの不均等な分割で、ブルース・ジャズの根幹となるグルーヴ。J-POPでもアクセントに使われる。',
        'body': '''## 定義
シャッフル（スウィング）は、楽譜上は均等な8分音符を、実際には長-短（おおむね2:1）の不均等なリズムで演奏するスタイル。三連符の最初の2つをタイでつないだリズムに近く、「ハネる」と表現される。

## 構造
ストレート（均等な8分音符）:
タタ タタ タタ タタ（1:1の比率）

シャッフル/スウィング:
ターッタ ターッタ ターッタ ターッタ（おおよそ2:1の比率）

三連符との関係:
三連符:   タタタ タタタ
シャッフル: タ（休）タ タ（休）タ（三連符の真ん中を休符に）

スウィングの度合い:
- ライトスウィング: 1:1に近い。ジャズのアップテンポ
- ミディアムスウィング: 2:1程度。標準的なジャズ
- ヘビーシャッフル: 3:1に近い。ブルース

## 具体例
- ブルースシャッフル: 12小節ブルースの基本リズム
- ジャズスウィング: ライドシンバルの「チーチキ」パターン
- ロックンロール: Chuck Berryのギターリフ
- J-POP: 「A・RA・SHI」嵐、「LOVEマシーン」モーニング娘。

## 実践のポイント
DTMではDAWのスウィング/シャッフル設定（通常50%〜75%の間）で手軽にハネたリズムが作れる。50%=ストレート、66%≒三連符シャッフル。微妙なスウィング量の調整でグルーヴの質が変わるため、リファレンス曲を参考に調整するとよい。''',
        'related_slugs': ['time-signature', 'syncopation', 'blues-form'],
    },

    # ===== 楽曲形式 (form) =====
    {
        'title': 'ブルース形式',
        'slug': 'blues-form',
        'category': 'form',
        'difficulty': 2,
        'tags': 'ブルース,12小節ブルース,ブルース進行,I-IV-V,AAB形式,blues',
        'summary': '12小節ブルースは、I-IV-Vの3コードで構成される12小節の循環形式。ロック・ジャズ・R&Bの源流であり、セッションの共通言語。AAB形式の歌詞構造を持つ。',
        'body': '''## 定義
ブルース形式（12小節ブルース）は、アメリカの黒人音楽から生まれた12小節の循環形式。I, IV, Vの3つのコード（すべてドミナント7th）を決まったパターンで繰り返す。歌詞はAAB形式（同じフレーズを2回、3行目で結論）。

## 構造
基本的な12小節ブルース（ディグリー表記）:
| I7  | I7  | I7  | I7  |
| IV7 | IV7 | I7  | I7  |
| V7  | IV7 | I7  | V7  |  ←ターンアラウンド

ジャズブルース（より洗練された進行）:
| I7    | IV7   | I7    | I7     |
| IV7   | IV7   | I7    | VIm7   |
| IIm7  | V7    | I7    | IIm7 V7|

■ 各キーでの基本ブルース進行
- A: A7-D7-A7-A7 / D7-D7-A7-A7 / E7-D7-A7-E7
- E: E7-A7-E7-E7 / A7-A7-E7-E7 / B7-A7-E7-B7
- G: G7-C7-G7-G7 / C7-C7-G7-G7 / D7-C7-G7-D7
- Bb: Bb7-Eb7-Bb7-Bb7 / Eb7-Eb7-Bb7-Bb7 / F7-Eb7-Bb7-F7
- F: F7-Bb7-F7-F7 / Bb7-Bb7-F7-F7 / C7-Bb7-F7-C7

## 具体例
- ロック: 「Rock and Roll」Led Zeppelin, 「Johnny B. Goode」Chuck Berry
- ブルース: 「Crossroads」Robert Johnson
- ジャズ: 「Billie's Bounce」Charlie Parker, 「Blue Monk」Thelonious Monk
- J-POP/歌謡曲にもブルースの影響は随所に見られる

## 実践のポイント
12小節ブルースはアドリブ・セッションの共通言語。まずは1つのキーで進行を覚え、マイナーペンタトニック＋ブルーノートでメロディを乗せる練習をする。ジャズブルースではII-Vを各所に挿入してリハーモナイズすることで、より洗練された進行になる。''',
        'related_slugs': ['pentatonic-scale', 'shuffle-swing', 'jpop-structure', 'diatonic-chords'],
    },
    {
        'title': 'J-POPの楽曲構成',
        'slug': 'jpop-structure',
        'category': 'form',
        'difficulty': 1,
        'tags': 'J-POP,楽曲構成,Aメロ,Bメロ,サビ,イントロ,アウトロ,大サビ,Cメロ,song structure',
        'summary': 'J-POPの楽曲は「イントロ→Aメロ→Bメロ→サビ」を基本構成とし、Cメロ（大サビ前のブリッジ）やラスサビなどの独自セクションを持つ。洋楽のVerse-Chorus形式を発展させた日本独自の構造。',
        'body': '''## 定義
J-POPの楽曲構成は、西洋のVerse-Chorus形式を基盤に日本独自の発展を遂げた楽曲形式。Aメロ（Verse）、Bメロ（Pre-Chorus）、サビ（Chorus）の3段構成が基本で、起承転結の美学が反映されている。

## 構造
典型的なJ-POPの構成:
イントロ → A → B → サビ → 間奏 → A → B → サビ → C → ラスサビ → アウトロ

各セクションの役割:
- イントロ: 楽曲の世界観を提示。印象的なリフやメロディ
- Aメロ(Verse): 物語の導入。比較的穏やか。低〜中音域
- Bメロ(Pre-Chorus): サビへの橋渡し。盛り上がりを構築。中音域
- サビ(Chorus): 楽曲のクライマックス。最もキャッチーなメロディ。高音域
- Cメロ(Bridge): ラスサビ前の新展開。転調や雰囲気の変化
- ラスサビ: 最後のサビ。転調や編曲の変化で最大の盛り上がり
- アウトロ: 余韻を残して終わる。フェードアウトまたは決め

バリエーション:
- サビ始まり: いきなりサビから始める（「夜に駆ける」YOASOBI）
- Bメロなし: A→サビの2段構成
- 大サビ: Cメロ後の転調サビ

## 具体例
- 「Lemon」米津玄師: A→B→サビ→A→B→サビ→C→ラスサビ
- 「夜に駆ける」YOASOBI: サビ始まり→A→B→サビ→A→B→サビ→C→ラスサビ
- 「紅蓮華」LiSA: イントロ（サビメロ使用）→A→B→サビ

## 実践のポイント
作曲初心者はまず「A→B→サビ」の1コーラスを完成させることから始める。各セクションで使うコード進行を変えると、展開感が生まれる（例: AメロはI始まり、サビはIV始まり）。サビは曲中で最も高い音域を使い、メロディの跳躍やリズムの密度を上げることで「サビ感」が出る。''',
        'related_slugs': ['blues-form', 'oudou-progression', 'komuro-progression', 'canon-progression'],
    },
    {
        'title': 'ソナタ形式',
        'slug': 'sonata-form',
        'category': 'form',
        'difficulty': 4,
        'tags': 'ソナタ形式,提示部,展開部,再現部,古典派,ベートーヴェン,モーツァルト,sonata form',
        'summary': 'ソナタ形式はクラシック音楽で最も重要な楽曲形式。提示部・展開部・再現部の3部構成で、2つの主題の対比と調的な旅が音楽的ドラマを生む。交響曲やソナタの第1楽章で使われる。',
        'body': '''## 定義
ソナタ形式は、18世紀の古典派音楽で確立された楽曲形式。提示部（Exposition）・展開部（Development）・再現部（Recapitulation）の3つのセクションからなり、主題の提示・発展・帰結という論理的な構造を持つ。

## 構造
1. 提示部（Exposition）:
   - 第1主題: 主調で力強く提示
   - 経過部: 転調の橋渡し
   - 第2主題: 属調（長調の場合）または平行調（短調の場合）で対比的に提示
   - 小結尾: 提示部を締めくくる

2. 展開部（Development）:
   - 提示部の主題を様々な調で変形・分解・組み合わせ
   - 最も自由で劇的なセクション

3. 再現部（Recapitulation）:
   - 第1主題: 主調で再現
   - 第2主題: 主調に統一して再現（提示部との重要な違い）
   - コーダ: 全体を締めくくる

## 具体例
- ベートーヴェン: 交響曲第5番「運命」第1楽章
- モーツァルト: ピアノソナタ K.545 第1楽章
- ハイドン: 多くの交響曲・弦楽四重奏の第1楽章

## 実践のポイント
ソナタ形式の「提示→展開→回帰」の構造は、ポップスの作曲にも応用できる。「テーマを提示し、発展させ、変化した形で回帰する」という大きな流れは、あらゆる音楽のストーリーテリングの基本。プログレッシブロックの大曲や映画音楽にも影響を与えている。''',
        'related_slugs': ['key-modulation', 'blues-form', 'jpop-structure'],
    },
]


class Command(BaseCommand):
    help = '音楽理論のシードデータをデータベースに投入します'

    def handle(self, *args, **options):
        created_count = 0
        updated_count = 0
        for data in SEED_DATA:
            related_slugs = data.pop('related_slugs', [])
            topic, created = Topic.objects.update_or_create(
                slug=data['slug'],
                defaults=data,
            )
            if created:
                created_count += 1
            else:
                updated_count += 1
            data['related_slugs'] = related_slugs

        # Remove technique topics that are no longer in seed data
        seed_slugs = [d['slug'] for d in SEED_DATA]
        deleted_count, _ = Topic.objects.exclude(slug__in=seed_slugs).delete()

        # Set up related_topics after all topics are created
        for data in SEED_DATA:
            topic = Topic.objects.get(slug=data['slug'])
            related = Topic.objects.filter(slug__in=data.get('related_slugs', []))
            topic.related_topics.set(related)

        total = Topic.objects.count()
        self.stdout.write(self.style.SUCCESS(
            f'新規: {created_count}件 / 更新: {updated_count}件 / 削除: {deleted_count}件（全{total}件）'
        ))
