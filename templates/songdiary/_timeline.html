{% if project.memos.all %}
<div class="space-y-3 relative">
    <div class="absolute left-5 top-0 bottom-0 w-0.5 bg-cosmic-400/30 dark:bg-cosmic-400/20"></div>
    {% for memo in project.memos.all %}
    <div class="relative pl-10" data-memo-type="{{ memo.memo_type }}" x-data="{ editing: false }">
        <div class="absolute left-4 top-4 w-3 h-3 rounded-full bg-cosmic-400"></div>
        <div class="bg-white/80 dark:bg-white/5 backdrop-blur-md rounded-2xl p-4 border border-cosmic-200/30 dark:border-white/10">
            <div class="flex justify-between items-start">
                <div class="flex items-center gap-2 text-xs text-cosmic-600/60 dark:text-white/50 mb-2">
                    {% if memo.memo_type == 'text' %}üìù{% elif memo.memo_type == 'audio' %}üé§{% else %}üì∑{% endif %}
                    <span>{{ memo.created_at|date:"Y/m/d H:i" }}</span>
                </div>
                <div class="flex items-center gap-2">
                    {% if memo.memo_type == 'text' %}
                    <button @click="editing = !editing" x-show="!editing"
                            class="text-nebula-500 dark:text-nebula-300 hover:text-nebula-400 text-xs">Á∑®ÈõÜ</button>
                    {% endif %}
                    <button hx-post="{% url 'songdiary:delete_memo' project.pk memo.pk %}"
                            hx-target="#timeline" hx-swap="innerHTML" hx-confirm="ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü"
                            class="text-comet dark:text-comet/80 hover:text-red-600 text-xs">√ó</button>
                </div>
            </div>
            {% if memo.memo_type == 'text' %}
            <!-- Display mode -->
            <p x-show="!editing" class="text-sm whitespace-pre-line">{{ memo.text_content }}</p>
            <!-- Edit mode -->
            <form x-show="editing" x-cloak
                  hx-post="{% url 'songdiary:edit_memo' project.pk memo.pk %}"
                  hx-target="#timeline" hx-swap="innerHTML"
                  class="space-y-2">
                {% csrf_token %}
                <textarea name="text_content" rows="3"
                          class="w-full rounded-xl border border-cosmic-200/30 dark:border-white/10 bg-white/80 dark:bg-white/5 px-3 py-2 text-sm focus:ring-2 focus:ring-cosmic-400/50">{{ memo.text_content }}</textarea>
                <div class="flex gap-2">
                    <button type="submit" class="bg-gradient-to-r from-cosmic-500 to-nebula-500 text-white px-3 py-1 rounded-lg text-xs font-bold">‰øùÂ≠ò</button>
                    <button type="button" @click="editing = false" class="text-xs text-cosmic-600/60 dark:text-white/50 hover:text-cosmic-500">„Ç≠„É£„É≥„Çª„É´</button>
                </div>
            </form>
            {% elif memo.memo_type == 'audio' %}
            <audio controls class="w-full" src="{{ memo.audio_file.url }}"></audio>
            {% elif memo.memo_type == 'photo' %}
            <img src="{{ memo.photo_file.url }}" alt="„É°„É¢ÂÜôÁúü" class="rounded-2xl max-h-64 object-cover">
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="text-center py-8 text-cosmic-600/50 dark:text-white/40">
    <div class="w-20 h-20 mx-auto mb-4 opacity-60">{% include "partials/baku/_baku_sleeping.html" %}</div>
    „É°„É¢„Åå„Åæ„Å†„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ‰∏ä„ÅÆ„Éï„Ç©„Éº„É†„Åã„Çâ„É°„É¢„ÇíËøΩÂä†„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ
</div>
{% endif %}
